


<p>Metadata can be incorporated to allow additional functionality in
repeat calling (correcting batch effects across fragment analysis runs)
and index peak assignment (assigning index peak from another
sample).</p>
<p>There are several important factors to a successful repeat
instability experiment and things to consider when using this tool:</p>
<ul>
<li><p>(required) Each sample has a unique id, usually the file
name</p></li>
<li><p>(optional) Baseline control for your experiment. For example,
specifying a sample where the modal allele is the inherited repeat
length (eg a mouse tail sample) or a sample at the start of a
time-course experiment. This is indicated with a <code>TRUE</code> in
the <code>metrics_baseline_control</code> column of the metadata.
Samples are then grouped together with the <code>metrics_group_id</code>
column of the metadata. Multiple samples can be
<code>metrics_baseline_control</code>, which can be helpful for the
average repeat gain metric to have a more accurate representation of the
average repeat at the start of the experiment.</p></li>
<li><p>(optional) There are two main correction approaches that are
somewhat related: either ‘batch’ or ‘repeat’ in
<code>call_repeats()</code>.</p>
<ul>
<li><p>Batch correction is relatively simple and just requires you to
link samples across batches by indicating them from metadata. But even
though the repeat size that is return will be precise, it will not be
accurate and underestimates the real repeat length. This correction can
be achieved by running a couple of samples in every fragment analysis
run, or having a single run that takes a couple of samples from every
run together, thereby linking them. These samples are indicated with
batch_run_id (to group samples by fragment analysis run) and
batch_sample_id (to enable linking samples across batches).</p></li>
<li><p>By contrast, repeat correction can be used to accurately call
repeat lengths (which also corrects the batch effects). However, the
repeat correction will only be as good as your sample(s) used to call
the repeat length.</p>
<ul>
<li><p>With how repeat correction works in this app, it’s helpful to i)
use the same samples across multiple runs (visualizations help you check
that correction is consistent across runs), and ii) using multiple
samples for correction for each run (helpful to help validate that each
sample was called correctly).</p></li>
<li><p>Similar to batch correction, batch_run_id (to group samples by
fragment analysis run) and batch_sample_id (to enable linking samples
across batches) are used, but importantly batch_sample_modal_repeat is
also set. The batch_sample_modal_repeat is the validated repeat length
of the modal repeat of the sample. This validated repeat length is then
used to call the repeat length of the modal repeat for each sample (by
each batch_run_id). Importantly, this correction requires you to know
with confidence the repeat length of the modal peak of the sample.
Therefore it’s important that the sample used for repeat correction has
a clear and prominent modal peak. If the repeat length is very long,
it’s common for the modal peak of a sample to change so if you use this
feature you’re going to have to understand the shape of the distribution
of your sample and double check that the correct peak has been called as
the modal peak. If the incorrect peak is called there are ways to
visualize that correct that in this app.</p></li>
</ul></li>
</ul></li>
</ul>
<p>Prepare a file (eg spreadsheet saved as .csv) with the following
columns. Use the specified column names below:</p>
<table>
<colgroup>
<col width="29%" />
<col width="25%" />
<col width="45%" />
</colgroup>
<thead>
<tr class="header">
<th>Metadata table column</th>
<th>Functionality metadata is associated with</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>unique_id</td>
<td>Required for adding metadata</td>
<td>The unique identifier for the fsa file. Usually the sample file
name. This must be unique, including across runs.</td>
</tr>
<tr class="even">
<td>metrics_group_id</td>
<td><code>assign_index_peaks</code>, allows grouping samples</td>
<td>This groups the samples for instability metric calculations. Provide
a group id value for each sample. For example, in a mouse experiment and
using the expansion index, you need to group the samples since they have
the same metrics baseline control (eg inherited repeat length), so
provide the mouse id.</td>
</tr>
<tr class="odd">
<td>metrics_baseline_control</td>
<td><code>assign_index_peaks</code>, allows grouping samples</td>
<td>This is related to metrics_group_id. Indicate with ‘TRUE’ to specify
which sample is the baseline control (eg mouse tail for inherited repeat
length, or day-zero sample in cell line experiments)</td>
</tr>
<tr class="even">
<td>batch_run_id</td>
<td><code>call_repeats</code>, allows setting <code>batch</code> or
<code>repeat</code> correction</td>
<td>This groups the samples by batch. Provide a value for each fragment
analysis run (eg date).</td>
</tr>
<tr class="odd">
<td>batch_sample_id</td>
<td><code>call_repeats</code>, allows setting <code>batch</code> or
<code>repeat</code> correction</td>
<td>This groups the sample across batches. Give a unique sample id to
each different sample.</td>
</tr>
<tr class="even">
<td>batch_sample_modal_repeat</td>
<td><code>call_repeats</code>, allows setting <code>repeat</code>
correction</td>
<td>The validated repeat length of the modal repeat of the sample.</td>
</tr>
</tbody>
</table>
