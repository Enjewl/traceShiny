---
output: html_fragment
---

## Tandem Repeat Analysis by Capillary Electrophoresis

This web server is designed to help guide users through a pipeline for short tandem repeat instability analysis from fragment analysis data. The inputs are fsa files or peak tables (eg Genemapper software output), and a user supplied metadata data-frame. This is an app version of our R package [trace](https://zachariahmclean.github.io/trace/), that has the following key features with additional interactivity:

-   Processing fsa files (ladder identification, base pair assignment, peak identification).

-   Identifying alleles and calling repeats.

-   Assigning index peaks and calculating instability metrics (e.g. expansion index or average repeat gain)

## Important experimental considerations

There are several important factors to a successful repeat instability experiment and things to consider when using this tool:

-   (required) Each sample has a unique id, usually the file name

-   (optional) Baseline control for your experiment. For example, specifying a sample where the modal allele is the inherited repeat length (eg a mouse tail sample) or a sample at the start of a time-course experiment. This is indicated with a `TRUE` in the `metrics_baseline_control` column of the metadata. Samples are then grouped together with the `metrics_group_id` column of the metadata. Multiple samples can be `metrics_baseline_control`, which can be helpful for the average repeat gain metric to have a more accurate representation of the average repeat at the start of the experiment.

-   (optional) Using common sample(s) across fragment analysis runs to correct systematic batch effects that occur with repeat-containing amplicons in capillary electrophoresis. There are slight fluctuations of size across runs for amplicons containing repeats that result in systematic differences around 1-3 base pairs. So, if samples are to be analyzed for different runs, the absolute bp size is not comparable unless this batch effect is corrected. This is only relevant when the absolute size of a amplicons are compared for grouping metrics as described above (otherwise instability metrics are all relative and it doesn't matter that there's systematic batch effects across runs) or when plotting traces from different runs. This correction can be achieved by running a couple of samples in every fragment analysis run, or having a single run that takes a couple of samples from every run together, thereby linking them. These samples are then indicated in the metadata with `batch_run_id` (to group samples by fragment analysis run) and `batch_sample_id` (to enable linking samples across batches).

This is not intended to be a genotyping tool in its current form. While the repeat lengths generated are precise, they are not accurate. We directly convert base pair size to repeat length, which underestimates the repeat length in fragment analysis data. However, this does not matter for instability metrics which are relative measures.

Select New to start fresh analysis, or Continue to load in a previous analysis.

```{r, include=FALSE}
#TOODO
## include license or free statement
## provide instructions for how to run localy


```
